"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.initFeatureFlags = void 0;
const bridge_1 = require("../bridge");
const errors_1 = require("../errors");
const utils_1 = require("../utils");
const maxOps = 500;
const intervalInMs = 1000 * 25;
const callBridge = (0, bridge_1.getCallBridge)();
const validatePayload = (payload) => {
    if (!payload || !payload.user) {
        throw new errors_1.BridgeAPIError('Missing required parameters. Parameter user is required in the payload.');
    }
    if (Object.values(payload).some((val) => typeof val === 'function')) {
        throw new errors_1.BridgeAPIError('Passing functions as part of the payload is not supported!');
    }
};
const _initFeatureFlags = (payload) => {
    validatePayload(payload);
    return callBridge('initFeatureFlags', { user: payload.user });
};
exports.initFeatureFlags = (0, utils_1.withRateLimiter)(_initFeatureFlags, maxOps, intervalInMs, 'Feature flags initialisation calls are rate limited at 500req/25s');
